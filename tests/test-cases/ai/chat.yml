name: "AI对话功能测试"
description: "验证AI对话的各种功能"
tags:
  - ai
  - feature
  - integration
environment: "production"
prerequisites:
  - "用户已登录"
  - "用户有足够的Token余额"

test-data:
  simple-questions:
    - "你好，请介绍一下自己"
    - "今天天气怎么样"
    - "帮我写一个Python函数"
  
  prd-generation:
    product: "智能健身应用"
    description: "一个基于AI的个性化健身指导应用"
    target: "健身爱好者和初学者"
    features:
      - "个性化训练计划"
      - "AI动作纠正"
      - "营养建议"

scenarios:
  - name: "简单对话测试"
    steps:
      - "进入AI对话页面"
      - "点击新建对话"
      - "输入消息 '${simple-questions[0]}'"
      - "点击发送或按回车"
      - "等待AI响应"
    expected:
      - "显示用户消息"
      - "显示AI正在输入指示器"
      - "收到AI响应"
      - "响应内容合理"
      - "Token使用量更新"

  - name: "PRD生成测试"
    steps:
      - "进入AI对话页面"
      - "选择PRD生成模式"
      - "输入产品名称 '${prd-generation.product}'"
      - "输入产品描述 '${prd-generation.description}'"
      - "输入目标用户 '${prd-generation.target}'"
      - "输入核心功能列表"
      - "点击生成PRD"
      - "等待生成完成"
    expected:
      - "显示生成进度"
      - "生成完整的PRD文档"
      - "包含产品概述、用户故事、功能列表等章节"
      - "可以预览PRD"
      - "可以导出PRD"

  - name: "多轮对话测试"
    steps:
      - "开始新对话"
      - "发送第一个问题"
      - "等待响应"
      - "基于响应发送后续问题"
      - "继续对话3-5轮"
    expected:
      - "AI能够记住上下文"
      - "响应连贯"
      - "对话历史正确显示"

  - name: "对话历史管理"
    steps:
      - "查看历史对话列表"
      - "点击某个历史对话"
      - "查看完整对话内容"
      - "尝试继续该对话"
      - "删除一个对话"
    expected:
      - "历史对话按时间排序"
      - "可以查看完整对话"
      - "可以继续历史对话"
      - "删除确认提示"
      - "删除后列表更新"

  - name: "AI类型切换"
    steps:
      - "进入对话页面"
      - "查看AI类型选项"
      - "切换到'问答AI'"
      - "发送问题"
      - "切换到'助手AI'"
      - "发送相同问题"
    expected:
      - "显示不同的AI类型"
      - "不同AI响应风格不同"
      - "切换流畅无错误"

  - name: "Token不足处理"
    prerequisites:
      - "用户Token余额接近0"
    steps:
      - "尝试发送消息"
      - "查看错误提示"
      - "点击充值链接"
    expected:
      - "显示Token不足提示"
      - "提示包含当前余额"
      - "提供充值入口"
      - "无法发送消息"

  - name: "长文本处理"
    steps:
      - "输入超过1000字的长文本"
      - "发送消息"
      - "等待AI处理"
    expected:
      - "正确显示长文本"
      - "AI能够处理长输入"
      - "响应时间合理"
      - "界面不会卡顿"